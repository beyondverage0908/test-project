<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=750, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>测试</title>
	<style>
		body {
			margin: 0px;
		}
	</style>
</head>
<body>
	<div id="the-current-page" style="position:absolute; float: left;"></div>
	<!-- <div id="all-contents-id" style="position: absolute; display: none;">
		<div id="contents-1-id" class="contents-1">
			<img class="content" src="./src/img/peak.png" alt="">
			<img class="content" src="./src/img/rank.png" alt="">
			<img class="content" src="./src/img/peak.png" alt="">
			<img class="content" src="./src/img/rank.png" alt="">
		</div>
		<div>
			<button class="btn btn-1">button1</button>
			<button class="btn btn-2">button2</button>
		</div>
	</div> -->
	
	<script src="./src/libs/jquery-1.9.1.min.js"></script>
	<!-- <script src="./src/js/dragula.js"></!-->
	<!-- <script src="./src/js/displace.js"></script> --> 
	<script src="./src/js/pipe.js"></script>
	<!-- <script src="./src/libs/swiper/swiper.animate1.0.3.min.js"></script> -->
	<!-- <script src="./src/libs/swiper/swiper.js"></script> -->

	<script>
		const pipe = window.pipe;

		// const drake = dragula([document.querySelector('#contents-1-id')], {
		// 	moves: function (el, source, handle, sibling) {
		// 		// console.log(el, source, handle, sibling);	
		// 		// console.log(el.offsetTop); 
		// 		return true; // elements are always draggable by default
		// 	},
		// 	accepts: function (el, target, source, sibling) {
		// 		// console.log(el, target, source, sibling);
		// 		// console.log(el.offsetTop);
		// 		return true; // elements can be dropped in any of the `containers` by default
		// 	},
		// });

		// const displace = window.displacejs;
		// ['.btn-1', '.btn-2'].map(cls => {
		// 	const el = document.querySelector(cls);
		// 	displace(el, {
		// 		onMouseDown: function () {
		// 			// console.log(el.offsetLeft, el.offsetTop);
		// 		},
		// 		onMouseUp: function () {
		// 			console.log(el.offsetLeft, el.offsetTop);
		// 			pipe.pageEmit('contents', el.offsetLeft);
		// 		}
		// 	})
		// });

		const ajaxConfig = {
			pagewidth: 750,
			rule: {
				active: true, // true
				image: './src/img/rule.png',
				content: '',
				position: {
					top: 110,
					left: 220
				}
			},
			title: '东财南京活动一览表',
			contents: [
				{
					type: 'content',
					image: 'http://img95.699pic.com/photo/50055/5642.jpg_wh300.jpg'
				},
				{
					type: 'content',
					image: 'https://cdn.pixabay.com/photo/2019/06/25/07/02/light-bulb-4297600__340.jpg'
				},
				{
					type: 'content',
					image: 'http://static.runoob.com/images/demo/demo4.jpg'
				},
				{
					type: 'content',
					image: 'http://static.runoob.com/images/demo/demo4.jpg'
				},
				{
					type: 'content',
					image: 'http://static.runoob.com/images/demo/demo4.jpg'
				}, 
				{
					type: 'passport',
					backgroundImage: 'xxxx.png',
					buttonImage: 'xxxxx.png',
					url: 'http://xxx.xxxx',
					target: 'web', // web, app
				}
			],
			buttons: [
				
			],
			topBanner: [
				{
					image: 'http://choicewechatreport.eastmoney.com/static/img/header.a659903.png',
					url: 'http://choice.eastmoney.com/Mobile/Register/?uid=9986014488792464&returnUrl=/activity/register/m/success.html',
					action: 'href', // app, href, passport
				},
				{
					image: 'http://183.136.162.242/fileupload/WeChatV/9986014488792464.png',
					url: 'http://choice.eastmoney.com/Mobile/Register/?uid=9986014488792464&returnUrl=/activity/register/m/success.html',
					action: 'app', // app, href, passport
				}
			],
			bottomBanner: [
				{
					image: 'http://choicewechatreport.eastmoney.com/static/img/header.a659903.png',
					url: 'http://choice.eastmoney.com/Mobile/Register/?uid=9986014488792464&returnUrl=/activity/register/m/success.html',
					action: 'href', // app, href, passport
				}
			],
			share: {
				title: '分享title',
				content: '分享内容',
				image: 'https://xx.xx.xx.png'
			},
			passport: {
				// image: 'http://127.0.0.1:9000/src/img/rank.png',
				position: {
					top: 111,
					left: 1111
				}
			}
		};
		setTimeout(function() {
			pipe.init(ajaxConfig);
			pipe.renderDom(600, false);
			pipe.storage.listener(function (key, value) {
				console.log(key, value);
			});
		}, 10);
		setTimeout(function() {
			pipe.storage.save('buttons', [
				{
					type: 'button',
					target: 'web', // web, app
					action: 'href', // href
					url: 'http://www.baidu.com',
					image: 'http://127.0.0.1:9000/src/img/rank.png',
					code: 'codeNi',
					position: {
						top: 150,
						left: 0
					}
				},
				{
					type: 'button',
					target: 'web', // web, app
					action: 'href', // href
					url: 'http://www.baidu.com',
					image: './src/img/rank.png',
					code: 'codeNi',
					position: {
						top: 300,
						left: 200,
					}
				},
				{
					type: 'button',
					action: 'href',
					target: 'app', // self, app
					// https://marketing.eastmoney.com/html/transfer/html/go_download.html?url=http%3A%2F%2Facttg.eastmoney.com%2Fpub%2Fxxlout_dfcfappwap_random_0000171a
					url: 'some-scheme.xx//',
					image: 'http://127.0.0.1:9000/src/img/rank.png',
					code: 'codeNi',
					position: {
						top: 500,
						left: 600
					}
				}
			], 'configer');
		}, 3000)


		// 模拟配置平台消息		
		// setTimeout(function() {
		// 	pipe.storage.save('contents', [
		// 		{
		// 			type: 'img',
		// 			image: 'https://cdn2.ettoday.net/images/4120/d4120647.jpg'
		// 		},
		// 		{
		// 			type: 'img',
		// 			image: 'http://choicewechatreport.eastmoney.com/static/img/header.a659903.png',
		// 		},
		// 		{
		// 			type: 'img',
		// 			image: 'https://cdn.pixabay.com/photo/2019/06/25/07/02/light-bulb-4297600__340.jpg'
		// 		},
		// 		{
		// 			type: 'img',
		// 			image: 'http://static.runoob.com/images/demo/demo4.jpg'
		// 		}
		// 	], 'configer');
		// }, 3000);
		// // 模拟配置平台监听消息
		// pipe.storage.listener(function (key, value) {
		// 	console.log(key, value);
		// });
	</script>
</body>
</html>