<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=750, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>测试</title>
	<link rel="stylesheet" href="./src/css/dragula.css">
	<style>
		body {
			margin-top: 0px;
		}
		.contents-1 {
			width: 750px;
			border: solid 1px salmon;
			margin: 0 auto;
		}
		.content {
			width: 100%;
			display: block;
			cursor: grab;
		}
		.btn-mask-container {
			position: absolute;
			height: 100%;
			width: 100%;
			background-color: yellow;
		}
		.btn {
			cursor: grabbing;
		}
		.btn-1 {
			/* position: absolute;
			top: 100px;
			left: 20px; */
			font-size: 40px;
		}
		.btn-2 {
			/* position: absolute;
			top: 100px;
			left: 290px; */
			font-size: 40px;
		}
	</style>
</head>
<body>
	<div id="all-contents-id" style="position: absolute;">
		<div id="contents-1-id" class="contents-1">
			<img class="content" src="./src/img/peak.png" alt="">
			<img class="content" src="./src/img/rank.png" alt="">
			<img class="content" src="./src/img/peak.png" alt="">
			<img class="content" src="./src/img/rank.png" alt="">
		</div>
		<button class="btn btn-1">button1</button>
		<button class="btn btn-2">button2</button>
	</div>
	
	<script src="./src/js/dragula.js"></script>
	<script src="./src/js/displace.js"></script>
	<script src="./src/js/pipe.js"></script>

	<script>
		const pipe = window.pipe;

		const drake = dragula([document.querySelector('#contents-1-id')], {
			moves: function (el, source, handle, sibling) {
				// console.log(el, source, handle, sibling);	
				console.log(el.offsetTop); 
				return true; // elements are always draggable by default
			},
			accepts: function (el, target, source, sibling) {
				// console.log(el, target, source, sibling);
				// console.log(el.offsetTop);
				return true; // elements can be dropped in any of the `containers` by default
			},
		});

		const displace = window.displacejs;
		['.btn-1', '.btn-2'].map(cls => {
			const el = document.querySelector(cls);
			displace(el, {
				onMouseDown: function () {
					console.log(el.offsetLeft, el.offsetTop);
				},
				onMouseUp: function () {
					console.log(el.offsetLeft, el.offsetTop);
					pipe.pageEvent(el.offsetLeft);
				}
			})
		});

		
		setTimeout(function() {
			pipe.configChange('contents', [
				{
					type: 'img',
					url: 'http://xx.xx.png'
				}	
			]);
		}, 3000);

		pipe.monitor = function(key, obj) {
			console.log(key, obj);
		}
	</script>
</body>
</html>